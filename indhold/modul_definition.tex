\section{Modul Definition}

%Måde at lave eksterne modul-apps uden at ændre hoved-app
%Definere output (tabeller/kolonner), samt input (afhængigheder)
%Evt. konfigurationsmuligheder for moduler afhængige af det
%Fleksibel måde at modtage data fra andre moduler, uden at skulle opdatere app(s). Dvs. ikke design-mønstre: observer, mediator, men gennem content provider.
% modularisering i Android; multiple apps under samme package

For at gøre systemet mere fleksibelt, vil vi udtænke en modul-baseret arkitektur.
Det skal være muligt at tilføje eksterne moduler, uden at have behov for at lave ændringer i hoved-applikationen.
Dette kan gøre sig gældende når der kommer nye sensorer på markedet, eller hvis der skal laves nye former for visninger til det allerede indsamlet data.
Til dette er der valgt at bruge JavaScript Object Notation (JSON) samt JSON Schema \cite{json_schema}.
Eksemplerne der bruges herefter vil derfor være i henholdsvis JSON eller JSON Schema.

\subsection{Typer af moduler}
Der vil findes i alt tre typer moduler; \textit{sensor}, \textit{analyse} og \textit{view}.\footnote{Der bruger engelske begreber her for at holde det implementerings-nært.}
Sensor-modulerne repræsenterer de fysiske sensorer til stede i telefon eller tilsluttet wearable.
De leverer data som analysis eller view modulerne skal bruge til at henholdsvis behandle eller vise data.
Baseret på en eller flere sensor- eller analysis-moduler, kan et analyse modul levere behandlet data, til brug af andre analysis-moduler, samt view-moduler.
View-modulerne bruges til visning af den rå sensor-data eller den behandlet analysis-data.

\subsection{Data}
Sensor- og analysis-moduler skal gøre data tilgængeligt for andre analysis- og view-moduler.
For at specificere hvordan den data skal gemmes, samt hvad der er tilgængeligt for andre, skal dette defineres for hvert modul af førstnævnte typer.
For hvert modul skal der defineres en eller flere tabeller, med navn, da det er muligt for ét modul at levere mere end én slags data.
For hver tabel defineres en eller flere kolonner, med et beskrivende navn, samt datatyper og evt. en måleenhed.

\subsection{Afhængigheder}
Et analysis- eller view-modul kan være afhængigt af andre sensor- eller analysis-moduler, da det kan være de skal bruge en bestemt slags data for at være anvendelige.
Derfor skal det defineres for hvert modul hvilke andre moduler det er afhængigt af.
Dette kan gøre på to måder; hard- eller soft-dependency.
En hard-dependency er ét andet modul, samt version, som det pågældende modul ikke kan fungere uden.
En soft-dependency er en liste af andre moduler, hvor mindst ét af de listede moduler skal være til stede på enheden.

\subsection{JSON og JSON Schema}
For at have en modul-beskrivelse der er læselig for både mennesker og maskiner, er JSON valgt.
Det burde også være muligt for ikke-tekniske personer at læse, skrive og forstå et JSON dokument.
For at sikre validiteten af eksternt leveret modul-beskrivelser, udarbejdes der et JSON Schema, som JSON-dokumenter kan holdes op imod og derved verificeres.
Det anvendte JSON Schema kan findes i \cref{app:json_schema}.

\paragraph{Eksempel} på en modul-beskrivelse.
Al meta-data er præfikset med \_ (underscore).
\begin{lstlisting}
{
  "name": "accelerometer",
  "_version": 1.0,
  "tables": [
    { "name": "accelerations",
      "columns": [
        { "name": "accX",
          "dataType": "REAL",
          "_unit": "g" },
        { "name": "accY",
          "dataType": "REAL",
          "_unit": "g" },
        { "name": "accZ",
          "dataType": "REAL",
          "_unit": "g" }
      ]}]}
\end{lstlisting}

